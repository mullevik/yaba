(function(){"use strict";var e={9137:function(e,t,n){var a=n(9242),o=n(3396);const i={class:"content"},l={class:"menu"};function s(e,t,n,a,s,r){const c=(0,o.up)("router-view"),u=(0,o.up)("NavigationComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",i,[(0,o.Wm)(c)]),(0,o._)("div",l,[(0,o.Wm)(u)])],64)}function r(e,t,n,a,i,l){const s=(0,o.up)("font-awesome-icon"),r=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("nav",null,[(0,o.Wm)(r,{to:{name:"home"}},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{icon:"fa-solid fa-table-list"})])),_:1}),(0,o.Wm)(r,{to:{name:"monthly"}},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{icon:"fa-solid fa-chart-bar"})])),_:1}),(0,o._)("a",null,[(0,o.Wm)(s,{icon:"fa-solid fa-chart-line"})]),(0,o.Wm)(r,{to:{name:"settings"}},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{icon:"fa-solid fa-gear"})])),_:1})])}var c={name:"NavigationComponent"},u=n(89);const d=(0,u.Z)(c,[["render",r],["__scopeId","data-v-2ab25cdd"]]);var m=d,h={name:"App",components:{NavigationComponent:m}};const p=(0,u.Z)(h,[["render",s]]);var g=p,b=n(5431);(0,b.z)("/yaba/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var f=n(3494),y=n(7749),v=n(8539),w=n(2483),L=n(7139);const S={key:0,style:{position:"relative",top:"2em"}},D=["onClick"],_={class:"labels"},E={class:"date"},x={class:"amount"},k={class:"buttons"};function C(e,t,n,i,l,s){const r=(0,o.up)("LabelComponent"),c=(0,o.up)("PendingLogs"),u=(0,o.up)("font-awesome-icon"),d=(0,o.up)("SubmitBudgetLogComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.wy)((0,o._)("div",null,[(0,o._)("section",null,[l.pastLogs.length<1?((0,o.wg)(),(0,o.iD)("span",S,[(0,o.Uk)("No past submissions... "),(0,o._)("i",null,[(0,o._)("a",{href:"#",onClick:t[0]||(t[0]=(...e)=>s.onNewSubmit&&s.onNewSubmit(...e))},"add new expense")])])):((0,o.wg)(!0),(0,o.iD)(o.HY,{key:1},(0,o.Ko)(l.pastLogs,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"budget-log-item",key:t,onClick:e=>s.selectPastLog(t)},[(0,o._)("div",_,[(0,o._)("span",E,(0,L.zw)(e.pending?"pending":new Date(1e3*e.unixTimestamp).toLocaleDateString()),1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.labels,((e,t)=>((0,o.wg)(),(0,o.j4)(r,{name:e,color:s.getLabelColor(e),key:t,clickable:!0,miniature:!0},null,8,["name","color"])))),128))]),(0,o._)("span",x,(0,L.zw)(e.amount)+" "+(0,L.zw)(e.currency.toUpperCase()),1)],8,D)))),128))]),(0,o._)("section",k,[(0,o.Wm)(c),(0,o._)("button",{class:"primary",onClick:t[1]||(t[1]=(...e)=>s.onNewSubmit&&s.onNewSubmit(...e))},[(0,o.Wm)(u,{icon:"fa-solid fa-circle-plus"}),(0,o.Uk)(" New expense ")])])],512),[[a.F8,!l.formOpen_]]),l.formOpen_?((0,o.wg)(),(0,o.j4)(d,{key:0,"past-log":l.selectedPastLog,onOnSubmitDone:s.onSubmitDone},null,8,["past-log","onOnSubmitDone"])):(0,o.kq)("",!0)],64)}const N={GREEN:"#78ca68ff",RED:"#ca6870ff",BLUE:"#6889caff",CYAN:"#68cac7ff",YELLOW:"#c6ca68ff",PINK:"#ca68b4ff",BROWN:"#ca9368ff",MAGENTA:"#9468caff",GRAY:"#cacacaff"},T=[{name:"groceries",color:N.MAGENTA},{name:"fuel",color:N.BROWN},{name:"rent",color:N.BLUE},{name:"restaurant",color:N.RED},{name:"food",color:N.YELLOW},{name:"alcohol",color:N.MAGENTA},{name:"entertainment",color:N.PINK},{name:"sport",color:N.GREEN},{name:"drugstore",color:N.BLUE},{name:"accommodation",color:N.BLUE},{name:"pharmacy",color:N.GREEN},{name:"public-transport",color:N.BROWN},{name:"subscription",color:N.CYAN},{name:"traveling",color:N.MAGENTA},{name:"clothes",color:N.PINK},{name:"music",color:N.PINK},{name:"home",color:N.BLUE},{name:"fast-food",color:N.RED},{name:"patisserie",color:N.PINK},{name:"video-games",color:N.MAGENTA},{name:"technology",color:N.CYAN},{name:"outdoor",color:N.BROWN},{name:"new",color:N.GREEN},{name:"barber",color:N.BROWN},{name:"optic",color:N.GREEN},{name:"health",color:N.RED},{name:"gift",color:N.MAGENTA}];function O(e,t,n,a,i,l){return(0,o.wg)(),(0,o.iD)("span",{style:(0,L.j5)(l.cssVars)},[(0,o.Uk)((0,L.zw)(n.name)+" ",1),n.removable?((0,o.wg)(),(0,o.iD)("button",{key:0,onClick:t[0]||(t[0]=t=>e.$emit("onRemove"))},"X")):(0,o.kq)("",!0)],4)}const A=N.GRAY;var P={name:"LabelComponent",props:{name:{required:!0,type:String},color:{default:A,type:String},removable:{default:!1,type:Boolean},clickable:{type:Boolean,default:!0},miniature:{type:Boolean,default:!1}},emits:["onRemove"],computed:{cssVars(){return{"--bg":this.color?this.color:A,"--right-padding":this.removable?"0.3em":"0.8em","--cursor":this.clickable?"pointer":"default","--font-size":this.miniature?"0.7em":"1em"}}}};const W=(0,u.Z)(P,[["render",O],["__scopeId","data-v-5c7c7db2"]]);var I=W;const M=e=>((0,o.dD)("data-v-440b242a"),e=e(),(0,o.Cn)(),e),B={class:"amount-section"},R=M((()=>(0,o._)("option",{value:"CZK",selected:""},"CZK",-1))),U=M((()=>(0,o._)("option",{value:"EUR"},"EUR",-1))),G=[R,U],Y=["disabled"],F={key:0},j={key:1};function V(e,t,n,i,l,s){const r=(0,o.up)("LabelSelectionComponent"),c=(0,o.up)("font-awesome-icon");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(r,{modelValue:l.selectedLabels,"onUpdate:modelValue":t[0]||(t[0]=e=>l.selectedLabels=e),"available-labels":l.availableLabels,class:"selected-labels-section",style:(0,L.j5)(s.cssVars),"always-expanded":!0},null,8,["modelValue","available-labels","style"]),(0,o._)("div",B,[(0,o.wy)((0,o._)("input",{ref:"inputAmount",type:"number",name:"amount",id:"input-amount","onUpdate:modelValue":t[1]||(t[1]=e=>l.amount=e),placeholder:"0"},null,512),[[a.nr,l.amount]]),(0,o.wy)((0,o._)("select",{name:"currency",id:"input-currency",form:"main-form","onUpdate:modelValue":t[2]||(t[2]=e=>l.currency=e)},G,512),[[a.bM,l.currency]]),(0,o._)("button",{style:(0,L.j5)(s.cssVars),disabled:!l.ableToSubmit,onClick:t[3]||(t[3]=(...e)=>s.submitAmount&&s.submitAmount(...e)),class:"primary"},[l.pendingSubmit?((0,o.wg)(),(0,o.iD)("span",F,[(0,o.Wm)(c,{icon:"fa-solid fa-spinner",spin:""})])):((0,o.wg)(),(0,o.iD)("span",j,[(0,o.Wm)(c,{icon:"fa-solid fa-paper-plane"}),(0,o.Uk)(" Submit")]))],12,Y)]),(0,o._)("div",{class:"under-amount-section-filler",style:(0,L.j5)(s.cssVars)},null,4)],64)}n(7658);function $(e,t,n){return{unixTimestamp:Math.floor((new Date).getTime()/1e3),amount:e,currency:t,labels:n}}n(541);var z=n(1373);const K=(0,z.Z)(),Z={NEW_BUDGET_LOG_STORED:"NEW_BUDGET_LOG_STORED"};function H(){K.emit(Z.NEW_BUDGET_LOG_STORED)}function q(e){K.on(Z.NEW_BUDGET_LOG_STORED,e)}var J=n(4806),Q=n.n(J);const X={API_KEY:"API_KEY",API_ENDPOINT:"ENDPOINT",BUDGET_LOGS:"BUDGET_LOGS",PAST_LABELS:"PAST_LABELS"},ee=40,te=40;function ne(e){console.log(`LOCAL_STORAGE_UTILS ${e}`)}function ae(){return localStorage.getItem(X.API_KEY)}function oe(e){ne(`Setting API KEY: ${e}`),localStorage.setItem(X.API_KEY,e)}function ie(){return localStorage.getItem(X.API_ENDPOINT)}function le(e){return ne(`Setting API Endpoint: ${e}`),localStorage.setItem(X.API_ENDPOINT,e)}function se(){const e=localStorage.getItem(X.BUDGET_LOGS);return null===e||""==e?[]:JSON.parse(e)}function re(){const e=localStorage.getItem(X.PAST_LABELS);return null==e||""==e?[]:JSON.parse(e)}function ce(e){localStorage.setItem(X.PAST_LABELS,JSON.stringify([...e,...re()].slice(0,te)))}function ue(){const e={};for(const[t,n]of re().entries())n in e?e[n]+=1/(t+1):e[n]=1/(t+1);return e}function de(e){const t=se();t.unshift(e);const n=t.filter((e=>!e.pending));if(!e.pending&&n.length>=ee){let e=0;for(const[n,a]of t.entries())a.pending||(e=n);t.splice(e,1)}localStorage.setItem(X.BUDGET_LOGS,JSON.stringify(t)),ce(e.labels),H()}function me(e){const t=se(),n=t.findIndex((t=>Q().isEqual(t,e)));return n<0?(ne(`BudgetLog ${e} not found in pending budget logs and thus can not be removed.`),t):(t.splice(n,1),localStorage.setItem(X.BUDGET_LOGS,JSON.stringify(t)),H(),t)}function he(e){console.log(`API ${e}`)}function pe(e,t){return{api_key:t,unix_timestamp:e.unixTimestamp,amount:e.amount,currency:e.currency,labels:e.labels.join(", ")}}function ge(e){if(he(`received response with status ${e.status}`),!e.ok){const t=new Error("Received non-2xx response from API");throw t.response=e,t}return e.json()}function be(e){const t=ie();null!==t&&""!=t||(he("no endpoint"),Promise.reject(new Error("No API Endpoint set in client settings")));const n=ae();null!==n&&""!=n||(he("no api key"),Promise.reject(new Error("No API_KEY set in client settings.")));const a=JSON.stringify(pe(e,n));return he(`sending ${a} to ${t}`),fetch(t,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},redirect:"follow",body:a}).then((e=>ge(e))).then((e=>{if(he(`received response body ${JSON.stringify(e)}`),!("status"in e)||"ok"!=e["status"])throw new Error("status == ok not found in response body");return e}))}function fe(e,t){const n=ie();return null!==n&&""!=n||(he("no endpoint"),Promise.reject(new Error("No API Endpoint set in client settings"))),he(`sending request to ${n} with ?year=${e} ?month=${t}`),fetch(`${n}?`+new URLSearchParams({year:e,month:t})).then((e=>ge(e))).then((e=>(he(`received response body ${JSON.stringify(e)}`),e)))}const ye={id:"container"},ve={class:"selected-labels"},we={key:0,class:"available-labels"};function Le(e,t,n,a,i,l){const s=(0,o.up)("LabelComponent"),r=(0,o.up)("FreeTextLabelComponent"),c=(0,o.up)("AvailableLabelsComponent"),u=(0,o.up)("font-awesome-icon");return(0,o.wg)(),(0,o.iD)("div",ye,[(0,o._)("div",ve,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.modelValue,((e,t)=>((0,o.wg)(),(0,o.j4)(s,{key:t,name:e.name,color:e.color,removable:!0,onOnRemove:e=>this.removeLabel(t)},null,8,["name","color","onOnRemove"])))),128)),(0,o.Wm)(r,{placeholder:l.placeholder,onOnLabelSubmit:this.addLabel,onOnTextChanged:t[0]||(t[0]=e=>this.searchText=e)},null,8,["placeholder","onOnLabelSubmit"])]),this.isExpanded?((0,o.wg)(),(0,o.iD)("div",we,[(0,o.Wm)(c,{"available-labels":n.availableLabels,"search-text":i.searchText,onOnLabelSelected:this.selectLabel,class:"available-labels-section",style:(0,L.j5)(e.cssVars)},null,8,["available-labels","search-text","onOnLabelSelected","style"]),n.alwaysExpanded?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("p",{key:0,class:"hide",onClick:t[1]||(t[1]=e=>i.isExpanded=!1)},[(0,o._)("i",null,[(0,o.Wm)(u,{icon:"fa-solid fa-angle-up"}),(0,o.Uk)(" hide")])]))])):(0,o.kq)("",!0)])}const Se=["placeholder","value"];function De(e,t,n,a,i,l){return(0,o.wg)(),(0,o.iD)("span",null,[(0,o._)("input",{type:"text",placeholder:n.placeholder,value:i.text,onInput:t[0]||(t[0]=e=>i.text=e.target.value)},null,40,Se)])}var _e={name:"FreeTextLabelComponent",props:{placeholder:{default:"... or type a custom label",type:String}},emits:["onLabelSubmit","onTextChanged"],data(){return{text:""}},watch:{text(e){this.$emit("onTextChanged",e.trim()),e.trim().length>0&&e.endsWith(" ")&&(this.$emit("onLabelSubmit",e.trim()),this.text="")}}};const Ee=(0,u.Z)(_e,[["render",De],["__scopeId","data-v-212e3a48"]]);var xe=Ee;const ke={key:0,class:"labels"},Ce={key:1};function Ne(e,t,n,a,i,l){const s=(0,o.up)("LabelComponent");return(0,o.wg)(),(0,o.iD)("section",null,[l.filteredLabels.length>0?((0,o.wg)(),(0,o.iD)("div",ke,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(l.filteredLabels,((e,t)=>((0,o.wg)(),(0,o.j4)(s,{key:t,name:e.name,color:e.color,clickable:!0,onClick:t=>this.$emit("onLabelSelected",e.name)},null,8,["name","color","onClick"])))),128))])):((0,o.wg)(),(0,o.iD)("div",Ce,"no available labels found (hit space to add new one)"))])}var Te={name:"AvailableLabels",components:{LabelComponent:I},props:{searchText:{default:""},availableLabels:{}},emits:["onLabelSelected"],computed:{sortedLabels(){return[...this.availableLabels].sort(((e,t)=>e.name.localeCompare(t.name))).sort(((e,t)=>{const n=e.name in this.labelScoreMap?this.labelScoreMap[e.name]:0,a=t.name in this.labelScoreMap?this.labelScoreMap[t.name]:0;return n<a?1:n>a?-1:0}))},filteredLabels(){return 0==this.searchText.trim().length?this.sortedLabels:this.sortedLabels.filter((e=>e.name.toLowerCase().includes(this.searchText.toLocaleLowerCase())))}},data(){return{labelScoreMap:ue()}}};const Oe=(0,u.Z)(Te,[["render",Ne],["__scopeId","data-v-27cae20e"]]);var Ae=Oe,Pe={name:"LabelSelectionComponent",components:{LabelComponent:I,FreeTextLabelComponent:xe,AvailableLabelsComponent:Ae},props:{modelValue:{default:[]},availableLabels:{default:[]},alwaysExpanded:{default:!1}},emits:["update:modelValue"],computed:{placeholder(){return this.modelValue.length>0?"... or type a custom label":"choose labels or start typing"}},data(){return{searchText:"",isExpanded:this.alwaysExpanded}},methods:{removeLabel(e){this.$emit("update:modelValue",this.modelValue.filter(((t,n)=>n!=e)))},addLabel(e,t=null){const n=this.modelValue.map((e=>e));n.push({name:e.trim().toLowerCase(),color:t}),this.$emit("update:modelValue",n)},selectLabel(e){const t=this.modelValue.map((e=>e)),n=this.availableLabels.filter((t=>t.name===e));1!==n.length&&console.warn(`Label with name ${e} not found in available labels.`),t.push(n[0]),this.$emit("update:modelValue",t)}},mounted(){document.getElementById("container").addEventListener("focusin",(()=>{this.isExpanded=!0}))}};const We=(0,u.Z)(Pe,[["render",Le],["__scopeId","data-v-595a2904"]]);var Ie=We;function Me(){return T}var Be={name:"SubmitBudgetLogComponent",components:{LabelSelectionComponent:Ie},props:{pastLog:{type:Object,default(){return{amount:null,currency:"czk",labels:[]}}}},emits:["onSubmitDone"],data(){return{amount:null,currency:"CZK",selectedLabels:[],availableLabels:Me(),ableToSubmit:!1,pendingSubmit:!1}},mounted(){this.$refs.inputAmount.focus(),this.currency=this.pastLog.currency.toUpperCase();const e=[],t=this.availableLabels.map((e=>e.name));for(const n of this.pastLog.labels){const a=t.indexOf(n);a>=0?e.push({name:n,color:this.availableLabels[a].color}):e.push({name:n,color:null})}this.selectedLabels=e},computed:{cssVars(){return{"--selected-labels-section-height":"5em","--amount-section-height":"20em"}}},watch:{amount:function(e){this.ableToSubmit=null!==e&&0!==e&&""!==e}},methods:{clearData(){this.amount=null,this.selectedLabels=[]},submitAmount(){this.ableToSubmit=!1,this.pendingSubmit=!0;const e=$(this.amount,this.currency,this.selectedLabels.map((e=>e.name)));be(e).then((()=>{e.pending=!1})).catch((t=>{console.error("Budget log could not have been sent"),console.error(t),e.pending=!0,this.pendingSubmit=!1})).finally((()=>{this.clearData(),de(e),this.ableToSubmit=!0,this.pendingSubmit=!1,this.$emit("onSubmitDone",e)}))}}};const Re=(0,u.Z)(Be,[["render",V],["__scopeId","data-v-440b242a"]]);var Ue=Re;const Ge=["disabled"],Ye={key:0},Fe={key:1},je={key:0};function Ve(e,t,n,i,l,s){const r=(0,o.up)("font-awesome-icon");return(0,o.wy)(((0,o.wg)(),(0,o.iD)("button",{onClick:t[0]||(t[0]=e=>s.manualSync()),disabled:!s.hasPendingLogs},[l.syncing_?((0,o.wg)(),(0,o.iD)("span",Ye,[(0,o.Wm)(r,{icon:"fa-solid fa-spinner",spin:""})])):((0,o.wg)(),(0,o.iD)("span",Fe,[(0,o.Wm)(r,{icon:"fa-solid fa-repeat"}),(0,o.Uk)(),l.pendingLogs.length>0?((0,o.wg)(),(0,o.iD)("span",je,(0,L.zw)(l.pendingLogs.length),1)):(0,o.kq)("",!0)]))],8,Ge)),[[a.F8,s.hasPendingLogs]])}var $e={name:"PendingLogs",components:{},data(){return{pendingLogs:se().filter((e=>e.pending)),syncing_:!1}},computed:{hasPendingLogs(){return this.pendingLogs.length>0&&!this.syncing_}},mounted(){q((()=>{this.pendingLogs=se().filter((e=>e.pending))}))},methods:{_recursiveSync(e,t){if(e>=t.length)return void(this.syncing_=!1);const n=t.at(e);be(n).then((a=>{this.removePendingLog(n),this._recursiveSync(e+1,t)})).catch((e=>{console.error(`Can not sync pending log ${JSON.stringify(n)}`),console.error(`${e}`),this.syncing_=!1}))},manualSync(){const e=[...this.pendingLogs];e.length<1||(this.syncing_=!0,this._recursiveSync(0,e))},removePendingLog(e){me(e)}}};const ze=(0,u.Z)($e,[["render",Ve]]);var Ke=ze;function Ze(){return T}const He={amount:null,currency:"czk",labels:[]};var qe={name:"BudgetLogsComponent",components:{LabelComponent:I,SubmitBudgetLogComponent:Ue,PendingLogs:Ke},data(){return{pastLogs:se(),availableLabels:Ze(),formOpen_:!1,selectedPastLog:He,showSettings_:!1}},mounted(){q((()=>{this.pastLogs=se()}))},methods:{getLabelColor(e){const t=this.availableLabels.filter((t=>t.name===e));return t.length<1?null:t[0].color},selectPastLog(e){this.selectedPastLog=this.pastLogs[e],this.formOpen_=!0},onNewSubmit(){this.selectedPastLog=He,this.formOpen_=!0},onSubmitDone(){this.formOpen_=!1}}};const Je=(0,u.Z)(qe,[["render",C],["__scopeId","data-v-8de85a34"]]);var Qe=Je;const Xe={class:"month-selection"},et={id:"month-current",class:"month-selection-item"},tt=["disabled"],nt={key:0,class:"info-note"},at={key:1,class:"info-note"},ot={key:2},it={class:"info-note"},lt={key:0},st={key:1};function rt(e,t,n,a,i,l){const s=(0,o.up)("font-awesome-icon"),r=(0,o.up)("LabelSelectionComponent"),c=(0,o.up)("BarChartComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",Xe,[(0,o._)("button",{id:"month-prev",class:"month-selection-item",onClick:t[0]||(t[0]=(...e)=>l.selectPreviousMonth&&l.selectPreviousMonth(...e))},[(0,o.Wm)(s,{icon:"fa-solid fa-arrow-left"})]),(0,o._)("span",et,(0,L.zw)(i.selectedDate.toLocaleDateString(l.getLocale(),{month:"long"}))+" "+(0,L.zw)(i.selectedDate.getFullYear()),1),(0,o._)("button",{id:"month-next",class:"month-selection-item",onClick:t[1]||(t[1]=(...e)=>l.selectNextMonth&&l.selectNextMonth(...e)),disabled:!l.hasNextMonth},[(0,o.Wm)(s,{icon:"fa-solid fa-arrow-right"})],8,tt)]),(0,o.Wm)(r,{modelValue:i.labelsToFilter,"onUpdate:modelValue":t[2]||(t[2]=e=>i.labelsToFilter=e),"available-labels":i.availableLabels},null,8,["modelValue","available-labels"]),(0,o._)("div",null,[0!=l.monthlyData.length||i.isFetching?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",nt,"No monthly data available")),i.isFetching?((0,o.wg)(),(0,o.iD)("div",at,[(0,o.Wm)(s,{icon:"fa-solid fa-spinner",spin:""}),(0,o.Uk)(" obtaining data for "+(0,L.zw)(i.selectedDate.toLocaleDateString(l.getLocale(),{month:"long"}))+" "+(0,L.zw)(i.selectedDate.getFullYear()),1)])):(0,o.kq)("",!0),l.monthlyData.length>0&&!i.isFetching?((0,o.wg)(),(0,o.iD)("div",ot,[(0,o._)("div",it,[(0,o.Uk)((0,L.zw)(this.total.toLocaleString())+" "+(0,L.zw)(this.currency)+" spent ",1),0==i.labelsToFilter.length?((0,o.wg)(),(0,o.iD)("span",lt,"in total")):((0,o.wg)(),(0,o.iD)("span",st,"on "+(0,L.zw)(i.labelsToFilter.map((e=>e.name)).join(" or ")),1))]),(0,o.Wm)(c,{data:this.monthlyData,currency:this.currency},null,8,["data","currency"])])):(0,o.kq)("",!0)])],64)}const ct={id:"container",class:"svg-container",align:"center"},ut=["width","height"];function dt(e,t,n,a,i,l){return(0,o.wg)(),(0,o.iD)("div",ct,[!0===i.redrawToggle?((0,o.wg)(),(0,o.iD)("svg",{key:0,id:"chart",width:i.svgWidth,height:l.svgHeight},null,8,ut)):(0,o.kq)("",!0)])}var mt=n(9157),ht={name:"BarChartComponent",mounted(){this.isLandscape=window.innerHeight<window.innerWidth,this.svgWidth=document.getElementById("container").offsetWidth,this.addResizeListener(),this.plot()},watch:{data:{deep:!0,handler(){this.plot()}}},props:["data","currency"],data(){return{svgWidth:0,redrawToggle:!0,animationDuration:500,animationStepDuration:100,isLandscape:!0,barHeight:50}},methods:{plot(){this.chart=mt.Ys("#chart"),this.chart.selectAll(".data-bar").data(this.data).join("rect").attr("class","data-bar").attr("x",this.xScale(0)).attr("y",(e=>this.yScale(e.label))).attr("fill",(e=>e.color)).attr("height",this.yScale.bandwidth()).attr("width",0).transition().delay(((e,t)=>t*this.animationStepDuration)).duration(this.animationDuration).attr("x",(()=>this.xScale(0))).attr("width",(e=>this.xScale(e.amount)-this.xScale(0))),this.chart.selectAll(".under-label-bar").data(this.data).join("rect").attr("class","under-label-bar").attr("x",this.labelColumnWidth).attr("y",(e=>this.yScale(e.label))).attr("width",0).attr("height",this.yScale.bandwidth()).attr("fill",(e=>e.color)).transition().delay(((e,t)=>t*this.animationStepDuration)).duration(this.animationDuration).attr("x",0).attr("width",this.labelColumnWidth),this.chart.selectAll(".label-text").data(this.data).join("text").attr("class","label-text").attr("x",0).attr("y",(e=>this.yScale(e.label)+this.yScale.bandwidth()/2)).attr("dx","0.5em").attr("dy","0.25em").attr("font-size","1em").attr("fill-opacity",0).text((e=>e.label)).transition().delay(((e,t)=>t*this.animationStepDuration)).duration(this.animationDuration).attr("x",0).attr("fill-opacity",1),this.chart.selectAll(".amount-text").data(this.data).join("text").attr("class","light amount-text").attr("font-family","sans-serif").attr("font-size","1em").attr("text-anchor","start").attr("x",(e=>this.xScale(e.amount))).attr("y",(e=>this.yScale(e.label)+this.yScale.bandwidth()/2)).attr("dx","0.5em").attr("dy","0.25em").attr("fill-opacity",0).text((e=>`${e.amount.toLocaleString()} ${this.currency}`)).call((e=>e.filter((e=>e.amount>.6*this.dataMax)).attr("text-anchor","end").attr("dx","-0.5em").attr("dy","0.25em").attr("class","dark amount-text"))).transition().delay(((e,t)=>t*this.animationStepDuration)).duration(this.animationDuration).attr("fill-opacity",1)},addResizeListener(){window.addEventListener("resize",(()=>{this.redrawToggle=!1,setTimeout((()=>{this.isLandscape=window.innerHeight<window.innerWidth,this.redrawToggle=!0,this.svgWidth=document.getElementById("container").offsetWidth,this.plot()}),300)}))}},computed:{dataMax(){return mt.Fp7(this.data,(e=>e.amount))},dataMin(){return mt.VV$(this.data,(e=>e.amount))},svgHeight(){return this.data.length*this.barHeight},yScale(){return mt.tiA().range([0,this.svgHeight]).padding(.1).domain(this.data.map((e=>e.label)))},labelColumnWidth(){return this.isLandscape?this.svgWidth/5:this.svgWidth/2.3},xScale(){return mt.BYU().range([this.labelColumnWidth+1,this.svgWidth]).domain([0,this.dataMax])}}};const pt=(0,u.Z)(ht,[["render",dt]]);var gt=pt;const bt={};for(const Vt of T)bt[Vt.name.toLowerCase()]=Vt.color;function ft(){return T}function yt(e,t){function n(e){return e.toLocaleLowerCase().replace(",","").trim()}return e.map((e=>{const t=e[1],a=new Set(t.split(" ").map((e=>n(e))));return{amount:e[0],cleanLabels:a}})).filter((e=>{const n=new Set([...e.cleanLabels].filter((e=>t.has(e))));return!(t.size>0&&0==n.size)}))}function vt(e){const t={};for(let a of e)for(const e of a.cleanLabels)t[e]=e in t?t[e]+a.amount:a.amount;const n=[];for(const[a,o]of Object.entries(t))n.push({label:a,amount:o,color:a in bt?bt[a]:N.GRAY});return n}function wt(e){return e.sort(((e,t)=>e["amount"]>t["amount"]?-1:e["amount"]<t["amount"]?1:0))}var Lt={name:"MonthlyComponent",mounted(){this.fetchMonthlyData()},data(){return{currentDate:new Date,selectedDate:new Date,rawMonthlyRows:[],isFetching:!1,currency:",-",labelsToFilter:[],availableLabels:ft()}},computed:{hasNextMonth(){return this.selectedDate.getMonth()<this.currentDate.getMonth()&&this.selectedDate.getFullYear()<=this.currentDate.getFullYear()},filteredRows(){return yt(this.rawMonthlyRows,new Set(this.labelsToFilter.map((e=>e.name))))},total(){return this.filteredRows.map((e=>e.amount)).reduce(((e,t)=>e+t),0)},monthlyData(){return wt(vt(this.filteredRows))}},watch:{selectedDate(e,t){this.fetchMonthlyData()}},methods:{getLocale(){return void 0!=navigator.languages?navigator.languages[0]:navigator.language},selectPreviousMonth(){const e=new Date(this.selectedDate.getTime());0!=e.getMonth()?e.setMonth(this.selectedDate.getMonth()-1):(e.setMonth(11),e.setFullYear(this.selectedDate.getFullYear()-1)),this.selectedDate=e},selectNextMonth(){const e=new Date(this.selectedDate.getTime());11!=e.getMonth()?e.setMonth(this.selectedDate.getMonth()+1):(e.setMonth(0),e.setFullYear(this.selectedDate.getFullYear()+1)),this.selectedDate=e},fetchMonthlyData(){this.isFetching=!0,fe(this.selectedDate.getFullYear(),this.selectedDate.getMonth()).then((e=>{this.rawMonthlyRows=e["rows"],this.currency=e["currency"]})).catch((()=>{this.rawMonthlyRows=[]})).finally((()=>{this.isFetching=!1}))}},components:{BarChartComponent:gt,LabelSelectionComponent:Ie}};const St=(0,u.Z)(Lt,[["render",rt]]);var Dt=St;const _t=(0,o._)("h2",null,"App settings",-1),Et={class:"form"},xt={id:"settings-form"},kt=(0,o._)("label",{for:"api-endpoint"},"API Endpoint",-1),Ct=(0,o._)("br",null,null,-1),Nt=(0,o._)("br",null,null,-1),Tt=(0,o._)("label",{for:"api-key"},"API Key",-1),Ot=(0,o._)("br",null,null,-1),At=(0,o._)("br",null,null,-1);function Pt(e,t,n,i,l,s){return(0,o.wg)(),(0,o.iD)(o.HY,null,[_t,(0,o._)("div",Et,[(0,o._)("form",xt,[kt,Ct,(0,o.wy)((0,o._)("input",{type:"input",name:"api-endpoint",id:"api-endpoint","onUpdate:modelValue":t[0]||(t[0]=e=>l.apiEndpoint=e)},null,512),[[a.nr,l.apiEndpoint]]),Nt,Tt,Ot,(0,o.wy)((0,o._)("input",{type:"input",name:"api-key",id:"api-key","onUpdate:modelValue":t[1]||(t[1]=e=>l.apiKey=e)},null,512),[[a.nr,l.apiKey]]),At])])],64)}var Wt={name:"SettingsFormComponent",components:{},data(){return{apiEndpoint:ie(),apiKey:ae()}},watch:{apiEndpoint:Q().debounce((function(e){le(e)}),400),apiKey:Q().debounce((function(e){oe(e)}),400)}};const It=(0,u.Z)(Wt,[["render",Pt]]);var Mt=It;const Bt={style:{position:"relative",top:"2em"}};function Rt(e,t,n,a,i,l){return(0,o.wg)(),(0,o.iD)("span",Bt,"So far, there is nothing here. Maybe there will be something in the future.")}var Ut={name:"NotFoundComponent"};const Gt=(0,u.Z)(Ut,[["render",Rt]]);var Yt=Gt;f.vI.add(v.gr5,v.EQ8,v.jHE,v.XCy,v.LM3,v.u7T,v.koM,v.Stf,v.eFW,v.acZ,v.onQ);const Ft=[{path:"/",component:Qe,name:"home"},{path:"/monthly",component:Dt,name:"monthly"},{path:"/settings",component:Mt,name:"settings"},{path:"/:catchAll(.*)",component:Yt,name:"404"}],jt=(0,w.p7)({history:(0,w.r5)("/yaba/"),routes:Ft});(0,a.ri)(g).use(jt).component("font-awesome-icon",y.GN).mount("#app")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,i){if(!a){var l=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],i=e[u][2];for(var s=!0,r=0;r<a.length;r++)(!1&i||l>=i)&&Object.keys(n.O).every((function(e){return n.O[e](a[r])}))?a.splice(r--,1):(s=!1,i<l&&(l=i));if(s){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,o,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,l=a[0],s=a[1],r=a[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(r)var u=r(n)}for(t&&t(a);c<l.length;c++)i=l[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},a=self["webpackChunkyaba"]=self["webpackChunkyaba"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(9137)}));a=n.O(a)})();
//# sourceMappingURL=app.1da3053a.js.map